<!doctype html>
<html>

<head>
    <title>L25- Sound and positional audio</title>
    <script src="https://aframe.io/releases/0.7.1/aframe.min.js"></script>
    <script>

        // Here we are creating a play component. 
        // The play component will be attached to the yellow sphere. 
        // When the yellow sphere will be clicked, the sound will start playing. 
        AFRAME.registerComponent('play', {
            init: function () {
                const element = document.querySelector("#yellow");
                this.el.addEventListener('click', function () {
                    element.components.sound.playSound();
                });
            }
        });

        AFRAME.registerComponent('stop', {
            init: function () {
                const element = document.querySelector("#yellow");
                this.el.addEventListener('click', function () {
                    element.components.sound.stopSound();
                });
            }
        });
    </script>
</head>

<body>
    <a-scene>

        <!-- Asset Management System -->
        <a-assets>
            <img id="ground" src="./floor-1024.jpg">
            <audio id="cantHide" src="../audio/cantHide.mp3"></audio>
        </a-assets>

        <!-- Camera -->
        <a-entity position="0 0 7">
            <a-camera>
                <a-cursor></a-cursor>
            </a-camera>
        </a-entity>

        <!-- Ground -->
        <a-plane src="#ground" scale="40 40 1" repeat="2 2" rotation="-90 0 0">
        </a-plane>

        <!-- Blue Cylinder -->
        <a-cylinder color="#0088FF" height="5" position="-2 2.5 0"
            sound="src: #cantHide; on:click; volume: 1; refDistance:4; rolloffFactor:4">
            <a-entity sound="src: #cantHide; autoplay:false" position="1.396 1.525 0">

            </a-entity>
        </a-cylinder>

        <!-- Yellow box with Play and Stop controls -->
        <a-box id="yellow" color="#FFAA00" position="1.5 0.5 0.5" sound="src: #cantHide">
            <!-- Play -->
            <a-sphere color="#00AA00" radius="0.25" position="-0.5 1 0" play></a-sphere>
            <!-- Stop -->
            <a-sphere color="#AA0000" radius="0.25" position="0.5 1 0" stop></a-sphere>
        </a-box>

    </a-scene>
</body>

</html>

<!-- 

    Sound and Postional value.
    1. We can cache audio in aframe asset management system 
    2. Then through sound attribute we can control sound 
    3. Mostly after user interaction only the sound will play 
    4. refDistance is after how many distance the sound will starts damping 
    5. rolloffFactor is the factor at which the damping will start
    6, 


-->